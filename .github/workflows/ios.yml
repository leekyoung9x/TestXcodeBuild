name: ðŸš€ iOS Build & Upload to TestFlight (Manual Trigger)

on:
  workflow_dispatch:  # Cho phÃ©p cháº¡y thá»§ cÃ´ng tá»« GitHub Actions UI

jobs:
  fastlane:
    name: ðŸš€ Build & Upload to TestFlight
    runs-on: macos-latest

    steps:
      - name: ðŸ“¥ Checkout repository
        uses: actions/checkout@v4
        
      - name: ðŸ›  Set up Git configuration with token
        run: |
          git config --global user.email "huytung55123@gmail.com"
          git config --global user.name "CI/CD Bot"
          git config --global url."https://${{ secrets.GH_ACCESS_TOKEN }}@github.com".insteadOf "https://github.com"

      - name: ðŸ›  Set up Xcode
        run: sudo xcode-select -switch /Applications/Xcode.app

      - name: ðŸ›  Install dependencies (Bundler & Fastlane)
        run: |
          gem install bundler
          bundle install || gem install fastlane

      - name: ðŸš€ Run Fastlane
        run: fastlane beta